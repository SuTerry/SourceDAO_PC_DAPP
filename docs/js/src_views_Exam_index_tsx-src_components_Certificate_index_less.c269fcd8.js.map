{"version":3,"file":"js/src_views_Exam_index_tsx-src_components_Certificate_index_less.c269fcd8.js","mappings":"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","sources":["webpack://sourcedao-pc-dapp/./src/components/Exam/CountDown/index.tsx","webpack://sourcedao-pc-dapp/./src/components/Exam/Submit/index.tsx","webpack://sourcedao-pc-dapp/./src/views/Exam/Dialog/index.tsx","webpack://sourcedao-pc-dapp/./src/assets/images/sbt/address.png","webpack://sourcedao-pc-dapp/./src/components/SBT/index.tsx","webpack://sourcedao-pc-dapp/./src/assets/images/sbt/mask.png","webpack://sourcedao-pc-dapp/./src/views/Exam/index.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\n\r\nimport { Card, CardContent, Typography } from '@mui/material'\r\n\r\nimport langHook from '@hooks/localHook'\r\n\r\nimport { examLang } from '@langs/index'\r\n\r\ninterface CountDownProps {\r\n  duration: number\r\n  setTimeout: (timeout: boolean) => void\r\n}\r\n\r\nlet countDown: undefined | NodeJS.Timeout = undefined\r\n\r\nexport default ({ duration, setTimeout }: CountDownProps): JSX.Element => {\r\n\r\n  const local = langHook()\r\n\r\n  const [count, setCount] = useState(duration * 60)\r\n\r\n  useEffect(() => {\r\n    countDown = setInterval(() => {\r\n      setCount((count) => {\r\n        if (count === 0) {\r\n          setTimeout(true)\r\n          clearInterval(countDown)\r\n        }\r\n        return count > 0 ? count - 1 : 0\r\n      })\r\n    }, 1000)\r\n    return () => clearInterval(countDown)\r\n  }, [])\r\n\r\n  const _count = (() => {\r\n    const _m = Math.floor(count / 60)\r\n    const _s = count % 60\r\n    const m = _m < 10 ? `0${_m}` : _m\r\n    const s = _s < 10 ? `0${_s}` : _s\r\n    if (m === '00' && s === '00') {\r\n      return '00:00'\r\n    } else {\r\n      return `${m}:${s}`\r\n    }\r\n  })()\r\n\r\n  return (\r\n    <Card sx={{ mb: 6 }}>\r\n      <CardContent>\r\n        <Typography sx={{ fontSize: 14 }} color=\"text.secondary\">\r\n          {local(examLang.timeRemaining)}\r\n        </Typography>\r\n        <Typography variant=\"h3\" sx={{\r\n          textAlign: 'center',\r\n          fontWeight: 700,\r\n        }} >\r\n          {_count}\r\n        </Typography>\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}","import React, { useEffect, useState } from 'react'\r\n\r\nimport { Button, Dialog, DialogTitle, DialogActions } from '@mui/material'\r\n\r\nimport langHook from '@hooks/localHook'\r\n\r\nimport { examLang } from '@langs/index'\r\n\r\n\r\ninterface SubmitProps {\r\n  answers: number[]\r\n  timeout: boolean\r\n  submit: () => void\r\n}\r\n\r\nconst buttonStyle = {\r\n  width: 200\r\n}\r\n\r\nexport default ({ answers, timeout, submit }: SubmitProps): JSX.Element => {\r\n\r\n  const local = langHook()\r\n\r\n  const [open, setOpen] = useState(false)\r\n\r\n  const [title, setTitle] = useState('')\r\n\r\n  const handleClose = () => {\r\n    setOpen(false)\r\n  }\r\n\r\n  const handleConfim = async () => {\r\n    handleClose()\r\n    submit()\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!timeout) return\r\n\r\n    setTitle(local(examLang.over))\r\n\r\n    setOpen(true)\r\n  }, [timeout])\r\n\r\n  const handleSubmit = async () => {\r\n\r\n    const index = answers.findIndex(answer => answer === 0)\r\n\r\n    if (index > -1) {\r\n      setTitle(local(examLang.undone))\r\n    } else {\r\n      setTitle(local(examLang.done))\r\n    }\r\n\r\n    setOpen(true)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Button\r\n        variant=\"contained\"\r\n        size=\"large\"\r\n        fullWidth\r\n        onClick={handleSubmit}\r\n      >\r\n        {local(examLang.submitted)}\r\n      </Button>\r\n\r\n      <Dialog\r\n        open={open}\r\n        onClose={timeout ? () => null : handleClose}\r\n        maxWidth=\"md\"\r\n        fullWidth={true}\r\n      >\r\n        <DialogTitle\r\n          sx={{\r\n            p: 20,\r\n            pb: 16,\r\n            textAlign: 'center',\r\n            fontSize: 36,\r\n            fontWeight: 700,\r\n          }}\r\n        >\r\n          {title}\r\n        </DialogTitle>\r\n        <DialogActions\r\n          sx={{\r\n            display: 'flex',\r\n            justifyContent: 'space-around',\r\n            mb: 6,\r\n          }}\r\n        >\r\n          {\r\n            !timeout && <Button variant=\"outlined\" sx={buttonStyle} onClick={handleClose}>\r\n              {local(examLang.cancel)}\r\n            </Button>\r\n          }\r\n          <Button variant=\"contained\" sx={buttonStyle} onClick={handleConfim} autoFocus>\r\n            {local(examLang.confirm)}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </>\r\n  )\r\n}","import React from 'react'\r\n\r\nimport { useNavigate } from 'react-router-dom'\r\n\r\nimport {\r\n  Box,\r\n  Button,\r\n  CircularProgress,\r\n  Dialog,\r\n  Slide,\r\n  Typography,\r\n} from '@mui/material'\r\n\r\nimport { TransitionProps } from '@mui/material/transitions'\r\n\r\nimport langHook from '@hooks/localHook'\r\nimport { examLang } from '@langs/index'\r\n\r\nimport Certificate, { CertificateProps } from '@components/Certificate'\r\n\r\nimport { CheckBox } from '@mui/icons-material'\r\n\r\nconst Transition = React.forwardRef(function Transition(\r\n  props: TransitionProps & {\r\n    children: React.ReactElement\r\n  },\r\n  ref: React.Ref<unknown>\r\n) {\r\n  return <Slide direction=\"up\" ref={ref} {...props} />\r\n})\r\n\r\ninterface DialogProps {\r\n  open: boolean\r\n  sbt: CertificateProps | undefined\r\n}\r\n\r\nexport default ({ open, sbt }: DialogProps): JSX.Element => {\r\n  const navigate = useNavigate()\r\n\r\n  const local = langHook()\r\n\r\n  const handle = () => navigate('/')\r\n\r\n  return (\r\n    <div>\r\n      <Dialog fullScreen open={open} TransitionComponent={Transition}>\r\n        <Box\r\n          sx={{\r\n            height: '100%',\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            justifyContent: 'center',\r\n            alignItems: 'center',\r\n          }}\r\n        >\r\n          {sbt ? (\r\n            <>\r\n              <CheckBox\r\n                sx={{\r\n                  mb: 1,\r\n                }}\r\n              />\r\n              <Typography variant=\"h6\" component=\"h6\" sx={{ mb: 4 }}>\r\n                {local(examLang.congratulations)}\r\n              </Typography>\r\n              <Certificate {...sbt} />\r\n              <Button\r\n                variant=\"outlined\"\r\n                sx={{\r\n                  mt: 4,\r\n                  width: 260,\r\n                }}\r\n                onClick={handle}\r\n              >\r\n                {local(examLang.confirm)}\r\n              </Button>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <CircularProgress />\r\n              <Typography sx={{ mt: 6 }}>\r\n                {local(examLang.examResult)}\r\n              </Typography>\r\n            </>\r\n          )}\r\n        </Box>\r\n      </Dialog>\r\n    </div>\r\n  )\r\n}\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAM1BMVEUAAAD///////////////////////////////////////////////////////////////+3leKCAAAAEHRSTlMA76Ag34BAEM+QML9wYF+vUsNgkwAAAKdJREFUKM+lkEsCwyAIRMWAv3w69z9tp9ZGbbNq3gLDjCDE/U/ICiS/fMkxo+HjpCeI8XLJgjQ6Htp6LIrH0B9C/RA96AjCUOAZFRAexuRDQmEUQGu5ngbwirvKziMCs3GVKVtFawsWpNPIMA5TkYWTjONGQ8W4SOhtV2S3r8Aa3FhQtzreX1vdtcO8OFKAzU3kepMPWNf6f6TOB34dka7PDvVLzNwdnqR6Brvb7bmbAAAAAElFTkSuQmCC\"","import React, { forwardRef } from 'react'\r\n\r\nimport { useAppSelector } from '@store/index'\r\n\r\nimport { scoreGrade, dateTimeConversion } from '@utils/index'\r\n\r\nimport './index.less'\r\n\r\nimport AddressImg from '@images/sbt/address.png'\r\nimport MaskImg from '@images/sbt/mask.png'\r\n\r\nexport interface SBTProps {\r\n  score: number\r\n  name: string\r\n  org: string\r\n  level: number\r\n}\r\n\r\nexport default forwardRef<HTMLDivElement, SBTProps>(\r\n  ({ score, name, org, level }, ref): JSX.Element => {\r\n    const { accountAddress } = useAppSelector((store) => store.wallet)\r\n\r\n    const time = new Date().getTime()\r\n    const year = dateTimeConversion(time, 'YYYY')\r\n    const month = dateTimeConversion(time, 'MMM')\r\n    const day = dateTimeConversion(time, 'DD')\r\n\r\n    const date = `${day}th ${month}, ${year}`\r\n\r\n    return (\r\n      <div className=\"sbt\" ref={ref}>\r\n        <p className=\"sbt_text\">This is to certify the degree of</p>\r\n        <h6 className=\"sbt_name\">{name} Level({level})</h6>\r\n        <p className=\"sbt_sourc\">{scoreGrade(score).toLocaleUpperCase()}</p>\r\n        <div className=\"sbt_addressImg\">\r\n          <img src={AddressImg} alt=\"\" />\r\n        </div>\r\n        <p className=\"sbt_address\">{accountAddress}</p>\r\n        <div className=\"sbt_bottom\">\r\n          <div className=\"sbt_bottom_date\">{date}</div>\r\n          <div className=\"sbt_bottom_org\">{org.toLocaleUpperCase()}</div>\r\n          <img src={MaskImg} className=\"sbt_bottom_mask\" />\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n)\r\n","export default \"data:image/png;base64,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\"","import React, {\r\n  ChangeEvent,\r\n  useEffect,\r\n  useState,\r\n  useCallback,\r\n  useRef,\r\n} from 'react'\r\nimport { findDOMNode } from 'react-dom'\r\n\r\nimport { useLocation, useNavigate } from 'react-router-dom'\r\n\r\nimport { Box } from '@mui/material'\r\n\r\nimport html2canvas from 'html2canvas'\r\n\r\nimport { useAppSelector } from '@store/index'\r\n\r\nimport { examApi, workflowApi, rewardApi, centerApi } from '@api/index'\r\n\r\n// import { dataURLtoFile } from '@utils/index'\r\n// import { add } from '@utils/ipfs'\r\n\r\nimport { CSTSCORELEVEL, CSTLEVEL } from '@constants/exam'\r\n\r\nimport Title from '@components/Exam/Title'\r\nimport Take, { ExamJson } from '@components/Exam/Take'\r\nimport CountDown from '@components/Exam/CountDown'\r\nimport Navigate from '@components/Exam/Navigate'\r\nimport Submit from '@components/Exam/Submit'\r\nimport Dialog from './Dialog'\r\nimport SBT, { SBTProps } from '@components/SBT'\r\n\r\nimport type { CertificateProps } from '@components/Certificate'\r\n\r\ntype State = {\r\n  type: number\r\n  level: keyof typeof CSTLEVEL\r\n  name: string\r\n  org: string\r\n  examId: string\r\n}\r\n\r\nexport default (): JSX.Element => {\r\n\r\n  const { state } = useLocation()\r\n\r\n  const navigate = useNavigate()\r\n\r\n  const { accountAddress } = useAppSelector((store) => store.wallet)\r\n\r\n  const beforeunload = (event: BeforeUnloadEvent) => {\r\n    event.returnValue = ''\r\n  }\r\n\r\n  const [exam, setExam] = useState<Array<null | ExamJson>>([])\r\n\r\n  const [answers, setAnswers] = useState<number[]>([])\r\n\r\n  const [duration, setDuration] = useState(-1)\r\n\r\n  const [currentExam, setCurrentExam] = useState(0)\r\n\r\n  const [timeout, setTimeout] = useState(false)\r\n\r\n  const [open, setOpen] = useState(false)\r\n\r\n  const [sbtData, setSbtData] = useState<SBTProps>()\r\n\r\n  const [sbt, setSbt] = useState<CertificateProps>()\r\n\r\n  const sbtRef = useRef<HTMLDivElement | null>(null)\r\n\r\n  const [routerState, setRouterState] = useState<State | undefined>()\r\n\r\n  const handleChange = useCallback(\r\n    (event: ChangeEvent<HTMLInputElement>, index: number) => {\r\n      const _answers = [...answers]\r\n      _answers.splice(index, 1, parseInt(event.target.value))\r\n      setAnswers(_answers)\r\n    },\r\n    [answers]\r\n  )\r\n\r\n  const submit = async () => {\r\n    setOpen(true)\r\n    const score = getScore()\r\n    const { org, name, level } = routerState!\r\n    setSbtData({ score, org, name, level: (level as unknown) as number })\r\n  }\r\n\r\n  const init = async () => {\r\n    if (!state) return navigate('/certificationCenter')\r\n\r\n    setRouterState(state)\r\n\r\n    addEventListener('beforeunload', beforeunload)\r\n\r\n    document.onkeydown = (e) => {\r\n      if (e.keyCode === 116) return false\r\n    }\r\n    document.oncontextmenu = () => false\r\n    \r\n    const cids = await examApi.getExam(state.examId)\r\n\r\n    const _duration = await examApi.getExaminationDuration(\r\n      state.type,\r\n      state.level\r\n    )\r\n\r\n    // dev code\r\n    setDuration(_duration)\r\n\r\n    setExam(new Array(cids.length).fill(null))\r\n    setAnswers(new Array(cids.length).fill(0))\r\n\r\n    // const exams = await cat<ExamJson>(cids)\r\n    const exams = await centerApi.exams(cids)\r\n\r\n    setExam(exams)\r\n  }\r\n\r\n  const getScore = () => {\r\n    let totalScore = 0\r\n    let userScore = 0\r\n    exam.forEach((item, index) => {\r\n      if (!item) return\r\n      totalScore += CSTSCORELEVEL[item.level]\r\n      if (item.standard === answers[index])\r\n        userScore += CSTSCORELEVEL[item.level]\r\n    })\r\n    const score = (userScore / totalScore) * 100\r\n    return Math.round(score * 100) / 100\r\n  }\r\n\r\n  useEffect(() => {\r\n    init()\r\n    return () => {\r\n      removeEventListener('beforeunload', beforeunload)\r\n      document.onkeydown = (e) => {\r\n        if (e.keyCode === 116) return true\r\n      }\r\n      document.oncontextmenu = () => true\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (!sbtData) return\r\n    const dom = findDOMNode(sbtRef.current) as HTMLElement\r\n    let hash = 'null'\r\n    const canvas = document.createElement('canvas')\r\n    const width = 300\r\n    const height = 400\r\n    canvas.width = width * 20\r\n    canvas.height = height * 20\r\n    // 设定 canvas css宽高为 DOM 节点宽高\r\n    canvas.style.width = `${width}px`\r\n    canvas.style.height = `${height}px`\r\n    // 获取画笔\r\n    html2canvas(dom, { canvas, scale: 20 }).then(async (canvas) => {\r\n      const dataURI = canvas.toDataURL('image/png')\r\n      const { score } = sbtData\r\n      // const file = dataURLtoFile(dataURI)\r\n      // hash = await add(file)\r\n      const resImg = await centerApi.uploadImage(dataURI)\r\n      hash = resImg.hash\r\n      \r\n      const res = await workflowApi.submit(\r\n        accountAddress,\r\n        routerState!.examId,\r\n        Math.floor(score),\r\n        answers,\r\n        hash\r\n      )\r\n      await res.wait()\r\n      const data = await rewardApi.getPreSBTMetaByExam(routerState!.examId)\r\n\r\n      setSbt({ sbt: dataURI, data })\r\n    })\r\n  }, [sbtData])\r\n\r\n  useEffect(() => {\r\n    if (state) navigate('.', { state: null }) \r\n  }, [navigate])\r\n\r\n  return (\r\n    <>\r\n      {routerState && duration > -1 && (\r\n        <>\r\n          <Box sx={{ display: 'flex' }}>\r\n            <Box sx={{ flex: 1, mr: 6 }}>\r\n              <Title\r\n                {...routerState}\r\n                duration={duration}\r\n                total={exam.length.toString()}\r\n              />\r\n              <Take\r\n                exam={exam}\r\n                currentExam={currentExam}\r\n                handleChange={handleChange}\r\n              />\r\n            </Box>\r\n            <Box sx={{ width: 360 }}>\r\n              <CountDown duration={duration} setTimeout={setTimeout} />\r\n              <Navigate answers={answers} setCurrentExam={setCurrentExam} />\r\n              <Submit answers={answers} timeout={timeout} submit={submit} />\r\n            </Box>\r\n          </Box>\r\n          <Dialog open={open} sbt={sbt} />\r\n          {sbtData && <SBT {...sbtData} ref={sbtRef} />}\r\n        </>\r\n      )}\r\n    </>\r\n  )\r\n}\r\n"],"names":["countDown","undefined","duration","setTimeout","local","langHook","useState","count","setCount","useEffect","setInterval","clearInterval","_m","_s","m","s","_count","Math","floor","Card","sx","mb","CardContent","Typography","fontSize","color","examLang","variant","textAlign","fontWeight","buttonStyle","width","answers","timeout","submit","open","setOpen","title","setTitle","handleClose","handleConfim","handleSubmit","index","findIndex","answer","Button","size","fullWidth","onClick","Dialog","onClose","maxWidth","DialogTitle","p","pb","DialogActions","display","justifyContent","autoFocus","Transition","React","props","ref","Slide","direction","sbt","navigate","useNavigate","fullScreen","TransitionComponent","Box","height","flexDirection","alignItems","CheckBox","component","Certificate","mt","CircularProgress","forwardRef","score","name","org","level","accountAddress","useAppSelector","store","wallet","time","Date","getTime","year","dateTimeConversion","month","day","date","className","scoreGrade","toLocaleUpperCase","src","alt","state","useLocation","beforeunload","event","returnValue","exam","setExam","setAnswers","setDuration","currentExam","setCurrentExam","sbtData","setSbtData","setSbt","sbtRef","useRef","routerState","setRouterState","handleChange","useCallback","_answers","splice","parseInt","target","value","getScore","init","addEventListener","document","onkeydown","e","keyCode","oncontextmenu","examApi","examId","cids","type","_duration","Array","length","fill","centerApi","exams","totalScore","userScore","forEach","item","CSTSCORELEVEL","standard","round","removeEventListener","dom","findDOMNode","current","hash","canvas","createElement","style","html2canvas","scale","then","dataURI","toDataURL","resImg","workflowApi","res","wait","rewardApi","data","flex","mr","Title","total","toString","Take","CountDown","Navigate","Submit","SBT"],"sourceRoot":""}